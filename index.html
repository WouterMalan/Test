<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Be My Valentine</title>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Pacifico&family=Quicksand:wght@400;600&display=swap");

    :root {
      --cream: #fff4f6;
      --blush: #f9c9d2;
      --peach: #ffd8c2;
      --lavender: #e8d7ff;
      --mint: #d9f7e5;
      --sky: #d6f0ff;
      --rose: #f58aa7;
      --berry: #a24a67;
      --cherry: #ff4d7a;
      --ink: #3d2b3d;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, var(--cream), #ffeef2 35%, #fde0ef 60%, #fbe4ff 100%);
      background-size: 140% 140%;
      animation: bloom 14s ease-in-out infinite;
      color: var(--ink);
      font-family: "Quicksand", sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px 16px 80px;
    }

    .scene {
      width: min(980px, 100%);
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.85), rgba(255, 236, 244, 0.8));
      border-radius: 32px;
      padding: 40px 32px 56px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 25px 60px rgba(164, 94, 120, 0.2);
    }

    .scene::before,
    .scene::after {
      content: "";
      position: absolute;
      width: 220px;
      height: 220px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.9), rgba(255, 216, 233, 0.2));
      filter: blur(2px);
      z-index: 0;
    }

    .scene::before {
      top: -80px;
      left: -60px;
    }

    .scene::after {
      bottom: -100px;
      right: -60px;
    }

    .header {
      display: flex;
      flex-direction: column;
      gap: 12px;
      text-align: center;
      position: relative;
      z-index: 1;
    }

    .header .eyebrow {
      font-family: "Pacifico", cursive;
      color: var(--rose);
      font-size: 1.2rem;
      letter-spacing: 0.02em;
    }

    h1 {
      margin: 0;
      font-family: "Playfair Display", serif;
      font-size: clamp(2.2rem, 4vw, 3.4rem);
      color: var(--berry);
    }

    .subline {
      margin: 0 auto;
      max-width: 640px;
      font-size: 1.05rem;
      line-height: 1.6;
    }

    .main {
      margin-top: 36px;
      display: grid;
      gap: 28px;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      position: relative;
      z-index: 1;
    }

    .card {
      padding: 22px 20px;
      background: linear-gradient(150deg, rgba(255, 255, 255, 0.88), rgba(255, 244, 247, 0.9));
      border-radius: 22px;
      border: 1px solid rgba(245, 138, 167, 0.25);
      box-shadow: 0 12px 30px rgba(242, 180, 199, 0.25);
      display: flex;
      flex-direction: column;
      gap: 14px;
      min-height: 200px;
    }

    .card h2 {
      margin: 0;
      font-size: 1.25rem;
      color: var(--berry);
      font-family: "Playfair Display", serif;
    }

    .card p {
      margin: 0;
      line-height: 1.6;
    }

    .valentine {
      grid-column: 1 / -1;
      background: linear-gradient(120deg, rgba(255, 211, 224, 0.9), rgba(232, 215, 255, 0.9));
      border: 1px solid rgba(162, 74, 103, 0.2);
      text-align: center;
      padding: 28px 22px;
      gap: 16px;
      position: relative;
      overflow: hidden;
    }

    .valentine h2 {
      font-size: clamp(1.5rem, 3vw, 2rem);
    }

    .valentine p {
      font-size: 1.1rem;
    }

    .cta {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 12px 24px;
      margin-top: 6px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--cherry), var(--rose));
      color: #fff;
      font-weight: 600;
      letter-spacing: 0.01em;
      border: none;
      box-shadow: 0 12px 24px rgba(245, 138, 167, 0.45);
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      animation: pulse 2.4s ease-in-out infinite;
    }

    .cta:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 16px 28px rgba(245, 138, 167, 0.55);
    }

    .cta:disabled {
      cursor: default;
      opacity: 0.85;
      animation: none;
    }

    .sparkles {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }

    .sparkle {
      position: absolute;
      width: 12px;
      height: 12px;
      background: radial-gradient(circle, #fff, rgba(255, 255, 255, 0));
      border-radius: 50%;
      opacity: 0.7;
      animation: float 8s ease-in-out infinite;
    }

    .sparkle:nth-child(1) { top: 12%; left: 12%; animation-delay: 0s; }
    .sparkle:nth-child(2) { top: 18%; right: 18%; animation-delay: 1.6s; }
    .sparkle:nth-child(3) { bottom: 15%; left: 20%; animation-delay: 3s; }
    .sparkle:nth-child(4) { bottom: 12%; right: 12%; animation-delay: 4.6s; }
    .sparkle:nth-child(5) { top: 45%; left: 45%; animation-delay: 6s; }

    .heart-row {
      display: flex;
      justify-content: center;
      gap: 14px;
      font-size: 1.6rem;
    }

    .reasons-list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 10px;
    }

    .reasons-list li {
      padding-left: 22px;
      position: relative;
      line-height: 1.6;
    }

    .reasons-list li::before {
      content: "‚ù§";
      position: absolute;
      left: 0;
      top: 1px;
      color: var(--rose);
      font-size: 0.95rem;
    }

    .reasons-card {
      grid-column: 1 / -1;
      background: linear-gradient(140deg, rgba(255, 228, 238, 0.95), rgba(232, 215, 255, 0.9));
      border: 1px solid rgba(162, 74, 103, 0.2);
      position: relative;
      overflow: hidden;
    }

    .reasons-card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(255, 255, 255, 0.6), transparent 55%);
      opacity: 0.8;
      pointer-events: none;
    }

    .reasons-title {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 8px 18px;
      border-radius: 999px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(255, 216, 233, 0.9));
      box-shadow: 0 10px 18px rgba(245, 138, 167, 0.25);
      font-size: 1.1rem;
      color: var(--berry);
      font-family: "Playfair Display", serif;
      align-self: flex-start;
    }

    .reasons-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px 18px;
    }

    .reasons-grid li {
      background: rgba(255, 255, 255, 0.75);
      border-radius: 16px;
      padding: 12px 14px 12px 28px;
    }

    .day-card {
      grid-column: 1 / -1;
      background: linear-gradient(120deg, rgba(214, 240, 255, 0.9), rgba(255, 216, 233, 0.85));
      border: 1px solid rgba(162, 74, 103, 0.2);
      position: relative;
      overflow: hidden;
    }

    .day-card.glow {
      animation: glow 2.4s ease-in-out;
      box-shadow: 0 0 30px rgba(245, 138, 167, 0.35), 0 0 60px rgba(214, 240, 255, 0.35);
    }

    .day-card h2 {
      margin-bottom: 4px;
    }

    .day-panel {
      display: grid;
      gap: 16px;
      margin-top: 10px;
    }

    .lock {
      background: rgba(255, 255, 255, 0.85);
      border-radius: 18px;
      padding: 16px;
      text-align: center;
    }

    .lock h3 {
      margin: 0 0 6px;
      font-family: "Playfair Display", serif;
      color: var(--berry);
    }

    .countdown {
      font-weight: 600;
      color: var(--berry);
      letter-spacing: 0.04em;
    }

    .story {
      display: none;
      background: rgba(255, 255, 255, 0.88);
      border-radius: 18px;
      padding: 18px;
    }

    .story.active {
      display: block;
    }

    .story h3 {
      margin: 0 0 10px;
      font-family: "Playfair Display", serif;
      color: var(--berry);
    }

    .story-steps {
      display: grid;
      gap: 10px;
    }

    .story-step {
      display: none;
      background: rgba(255, 255, 255, 0.85);
      border-radius: 14px;
      padding: 12px 14px;
    }

    .story-step.active {
      display: block;
    }

    .story-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 12px;
    }

    .ghost {
      background: rgba(255, 255, 255, 0.9);
      color: var(--berry);
      border: 1px solid rgba(162, 74, 103, 0.2);
      box-shadow: none;
      animation: none;
    }

    .floating-hearts {
      position: absolute;
      inset: 0;
      overflow: hidden;
      pointer-events: none;
      z-index: 0;
    }

    .floating-hearts span {
      position: absolute;
      font-size: 1.4rem;
      opacity: 0.35;
      animation: drift 12s linear infinite;
    }

    .floating-hearts span:nth-child(1) { left: 8%; animation-delay: 0s; top: 85%; }
    .floating-hearts span:nth-child(2) { left: 22%; animation-delay: 2s; top: 75%; }
    .floating-hearts span:nth-child(3) { left: 40%; animation-delay: 4s; top: 90%; }
    .floating-hearts span:nth-child(4) { left: 60%; animation-delay: 1s; top: 80%; }
    .floating-hearts span:nth-child(5) { left: 75%; animation-delay: 3s; top: 88%; }
    .floating-hearts span:nth-child(6) { left: 88%; animation-delay: 5s; top: 82%; }

    .footer-note {
      text-align: center;
      margin-top: 28px;
      font-size: 0.95rem;
      color: rgba(61, 43, 61, 0.7);
    }

    .celebration {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, rgba(255, 244, 246, 0.95), rgba(248, 226, 239, 0.9));
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
      z-index: 10;
    }

    .celebration.active {
      opacity: 1;
      pointer-events: all;
    }

    .celebration-card {
      background: linear-gradient(140deg, rgba(255, 255, 255, 0.9), rgba(255, 229, 240, 0.92));
      border-radius: 28px;
      padding: 28px 26px;
      text-align: center;
      max-width: 420px;
      box-shadow: 0 18px 40px rgba(164, 94, 120, 0.25);
    }

    .celebration-card h3 {
      margin: 0 0 10px;
      font-family: "Playfair Display", serif;
      color: var(--berry);
      font-size: 1.6rem;
    }

    .celebration-card p {
      margin: 0;
      line-height: 1.6;
    }

    .burst {
      position: absolute;
      inset: 0;
      overflow: hidden;
      pointer-events: none;
    }

    .burst-heart {
      position: absolute;
      font-size: 1.2rem;
      opacity: 0.75;
      animation: fall 2.6s ease-in forwards;
    }

    @keyframes drift {
      0% {
        transform: translateY(0) scale(1);
        opacity: 0.25;
      }
      50% {
        opacity: 0.6;
      }
      100% {
        transform: translateY(-120px) scale(1.15);
        opacity: 0;
      }
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-12px);
      }
    }

    @keyframes bloom {
      0%, 100% {
        background-position: 20% 20%;
      }
      50% {
        background-position: 80% 60%;
      }
    }

    @keyframes pulse {
      0%, 100% {
        transform: translateY(0) scale(1);
      }
      50% {
        transform: translateY(-1px) scale(1.03);
      }
    }

    @keyframes fall {
      0% {
        transform: translateY(-40px) scale(1);
        opacity: 0;
      }
      30% {
        opacity: 0.9;
      }
      100% {
        transform: translateY(280px) scale(1.1);
        opacity: 0;
      }
    }

    @keyframes glow {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.01);
      }
    }

    .gallery {
      /* Removed grid styles */
      display: none;
    }

    .memory-card {
      grid-column: 1 / -1;
      align-items: center;
      text-align: center;
      padding: 26px 22px 32px;
    }

    .memory-card h2 {
      font-size: 1.45rem;
    }

    .memory-container {
      position: relative;
      width: 100%;
      max-width: 980px;
      min-height: 760px;
      display: flex;
      align-items: center;
      justify-content: center;
      perspective: 1600px;
      margin: 20px auto 10px;
      padding: 10px 0 30px;
    }

    .memory-stack {
      position: relative;
      width: 820px;
      height: 620px;
      margin: 0 auto;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .memory-stack:hover {
      transform: scale(1.02);
    }

    .polaroid {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      background: linear-gradient(145deg, #ffffff, #fefefe);
      padding: 10px 10px 48px 10px;
      box-shadow: 
        0 22px 55px rgba(162, 74, 103, 0.28),
        0 10px 24px rgba(0, 0, 0, 0.12),
        inset 0 1px 0 rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      transition: transform 0.7s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.6s ease;
      display: flex;
      flex-direction: column;
      backface-visibility: hidden;
      transform-origin: center center;
      border: 1px solid rgba(230, 230, 230, 0.8);
    }

    .polaroid img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      background: #f0f0f0;
      border: 1px solid #eee;
      border-radius: 6px;
    }

    .polaroid::after {
      content: attr(data-caption);
      position: absolute;
      bottom: 14px;
      left: 0;
      width: 100%;
      text-align: center;
      font-family: "Pacifico", cursive;
      color: var(--berry);
      font-size: 1.15rem;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    }

    /* Animation states */
    .polaroid.fly-out {
      transform: translate(300px, -100px) rotate(25deg) scale(0.8);
      opacity: 0;
      pointer-events: none;
    }

    .polaroid.reset {
      transition: none;
      opacity: 0;
      pointer-events: none;
    }

    .instruction-hint {
      text-align: center;
      font-size: 0.95rem;
      color: var(--berry);
      opacity: 0.8;
      margin-top: -5px;
      margin-bottom: 15px;
      font-weight: 500;
    }

    #lightbox {
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }
    
    #lightbox.active {
      opacity: 1;
      pointer-events: all;
    }

    @media (max-width: 680px) {
      .scene {
        padding: 32px 20px 46px;
      }

      .card {
        min-height: auto;
      }

      .heart-row {
        font-size: 1.4rem;
      }

      .memory-container {
        min-height: 620px;
        padding: 20px 10px;
      }

      .memory-stack {
        width: 96%;
        max-width: 620px;
        height: 560px;
      }

      .polaroid {
        padding: 10px 10px 44px 10px;
      }

      .polaroid::after {
        font-size: 1rem;
        bottom: 12px;
      }
    }
  </style>
</head>
<body>
  <main class="scene">
    <div class="floating-hearts">
      <span>‚ô°</span>
      <span>‚ô°</span>
      <span>‚ô°</span>
      <span>‚ô°</span>
      <span>‚ô°</span>
      <span>‚ô°</span>
    </div>

    <section class="header">
      <div class="eyebrow">for my favorite person</div>
      <h1>You make my world softer, brighter, sweeter.</h1>
      <p class="subline">
        Every day with you feels like a pastel sunrise. Your laugh is my favorite melody,
        your kindness is my favorite place, and your smile is my favorite view.
      </p>
    </section>

    <section class="main">
      <div class="card reasons-card">
        <div class="reasons-title">Little Reasons I Adore You</div>
        <ul class="reasons-list reasons-grid">
          <li>You make me feel special and do so much to ensure I'm always at my happiest.</li>
          <li>You make me feel whole; every moment without you feels incomplete.</li>
          <li>I am captivated by your smile.</li>
          <li>I love trying to make you smile and seeing you at your happiest.</li>
          <li>You still give me butterflies every time I look at you.</li>
          <li>I miss you deeply whenever you're not near me.</li>
          <li>You listen with your whole heart, making everything feel lighter.</li>
          <li>You are my calm, my spark, and my favorite hello.</li>
          <li>You make simple days feel like celebrations.</li>
          <li>You are gentle, loyal, and wonderfully kind.</li>
          <li>You make me proud to be loved by you.</li>
          <li>You are my best friend and my safest place.</li>
          <li>You are the sweetest part of my day, every single day.</li>
          <li>Your love feels like the warmest, most comforting hug.</li>
          <li>You turn the smallest moments into forever memories.</li>
        </ul>
      </div>

      <div class="card memory-card" id="memoryCard">
        <h2>Relive Our Memories</h2>
        <div class="instruction-hint">Click the stack to shuffle through our moments &hearts;</div>
        <div class="memory-panel">
          <div class="memory-lock" id="memoryLock" style="display:none;">
            <h3>Memories Sealed</h3>
            <p>Come back on February 14 to unlock and relive our photo memories!</p>
          </div>
          <div class="memory-container" id="memoryContainer">
            <div class="memory-stack" id="memoryStack">
              <!-- Images injected via JS -->
            </div>
          </div>
        </div>
      </div>

      <div class="card day-card" id="dayCard">
        <h2>Open On Valentine‚Äôs Day Only</h2>
        <p>Something special unlocks on the day. Keep this close until then.</p>
        <div class="day-panel">
          <div class="lock" id="dayLock">
            <h3>Sealed with love</h3>
            <p>Come back on February 14 to open your story and surprise.</p>
            <div class="countdown" id="countdown">Counting the days...</div>
          </div>
          <div class="story" id="dayStory">
            <h3>Our Little Story</h3>
            <div class="story-steps" id="storySteps">
              <div class="story-step active" data-icon="üíñ">
                <h3>Our Beginning</h3>
                <p>From the moment I saw you in high school, I knew you were the one. You were my first and best Valentine's dance, a memory my heart never forgot.</p>
              </div>
              <div class="story-step" data-icon="‚ú®">
                <h3>The Cold Day, The Warmth of You</h3>
                <p>Our story truly began four years ago. I'll never forget that freezing cold hike where just having you next to me made me feel warmer than I've ever been.</p>
              </div>
              <div class="story-step" data-icon="ü§ù">
                <h3>A Hand to Hold</h3>
                <p>The first time I took your hand to cross that bridge, I knew I would always reach for you through any waters life might bring. It was a silent promise.</p>
              </div>
              <div class="story-step" data-icon="ü•∞">
                <h3>My Favorite Things</h3>
                <p>I fall in love with you all over again, every single day. Your soft heart, the way you get lost in my eyes, and the smile that lights up my darkest days.</p>
              </div>
              <div class="story-step" data-icon="üåü">
                <h3>A Brighter World</h3>
                <p>You radiate a light that makes everything around you more beautiful. Your laugh is the music my heart dances to, and I'm so grateful to see it every day.</p>
              </div>
              <div class="story-step" data-icon="üíå">
                <h3>My Promise to You</h3>
                <p>Every day with you is a gift. I promise to always be your best friend, to protect you, and to love you with everything I am. Rochelle, my Lovey, I am and will always be yours.</p>
              </div>
            </div>
            <div class="story-controls">
              <button class="cta ghost" type="button" id="prevStep">Back</button>
              <button class="cta" type="button" id="nextStep">Next Chapter</button>
              <button class="cta" type="button" id="wishGlow">Relive a Memory ‚ú®</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card valentine">
        <div class="sparkles">
          <span class="sparkle"></span>
          <span class="sparkle"></span>
          <span class="sparkle"></span>
          <span class="sparkle"></span>
          <span class="sparkle"></span>
        </div>
        <h2>Will you be my Valentine?</h2>
        <p>
          I choose you today, tomorrow, and always. Would you make me the happiest
          and say yes?
        </p>
        <p style="font-size:1.1rem; color:var(--berry); margin:10px 0 0 0; font-weight:600;">Send me a picture as proof! üì∏</p>
        <button class="cta" type="button" id="yesButton" style="display:none;">Yes, always üíó</button>
        <button class="cta" type="button" id="playTicTacToe">Play for my Heart üé≤</button>
        <!-- Tic Tac Toe Modal -->
        <div class="celebration" id="ticTacToeModal" style="z-index:20; background:rgba(255,244,246,0.98);">
          <div class="celebration-card" style="max-width:340px;">
            <h3>Win My Heart!</h3>
            <p style="margin-bottom:10px;">Play Tic Tac Toe to unlock my heart. You are X, I am O!</p>
            <div id="ticTacToeBoard" style="display:grid; grid-template-columns:repeat(3,48px); gap:8px; justify-content:center; margin:18px 0 10px;"></div>
            <div id="ticTacToeStatus" style="min-height:24px; font-weight:600; color:#a24a67;"></div>
            <button class="cta ghost" type="button" id="closeTicTacToe" style="margin-top:10px;">Close</button>
          </div>
        </div>
      </div>
    </section>

    <div class="footer-note">Made with all my heart, just for you.</div>
  </main>

  <div class="celebration" id="celebration">
    <div class="burst" id="burst"></div>
    <div class="celebration-card">
      <h3>My heart is yours.</h3>
      <p>
        Thank you for saying yes. I am the luckiest person in the world to love you, and I cannot wait for all
        the beautiful moments ahead of us.
      </p>
    </div>
  </div>

  <script>
    const yesButton = document.getElementById("yesButton");
    const playTicTacToe = document.getElementById("playTicTacToe");
    const ticTacToeModal = document.getElementById("ticTacToeModal");
    const ticTacToeBoard = document.getElementById("ticTacToeBoard");
    const ticTacToeStatus = document.getElementById("ticTacToeStatus");
    const closeTicTacToe = document.getElementById("closeTicTacToe");
        // --- Tic Tac Toe Game Logic ---
        let tttBoard = Array(9).fill("");
        let tttPlayer = "X";
        let tttGameOver = false;

        function renderTicTacToe() {
          ticTacToeBoard.innerHTML = "";
          tttBoard.forEach((cell, i) => {
            const btn = document.createElement("button");
            btn.textContent = cell;
            btn.style.width = "48px";
            btn.style.height = "48px";
            btn.style.fontSize = "1.7rem";
            btn.style.background = cell ? (cell === "X" ? "#f9c9d2" : "#e8d7ff") : "#fff";
            btn.style.border = "2px solid #a24a67";
            btn.style.borderRadius = "8px";
            btn.style.cursor = cell || tttGameOver ? "default" : "pointer";
            btn.disabled = !!cell || tttGameOver;
            btn.addEventListener("click", () => handleTicTacToeMove(i));
            ticTacToeBoard.appendChild(btn);
          });
        }

        function checkTicTacToeWin(board, player) {
          const wins = [
            [0,1,2],[3,4,5],[6,7,8],
            [0,3,6],[1,4,7],[2,5,8],
            [0,4,8],[2,4,6]
          ];
          return wins.some(line => line.every(idx => board[idx] === player));
        }

        function checkTicTacToeDraw(board) {
          return board.every(cell => cell);
        }

        function handleTicTacToeMove(idx) {
          if (tttGameOver || tttBoard[idx]) return;
          tttBoard[idx] = tttPlayer;
          renderTicTacToe();
          if (checkTicTacToeWin(tttBoard, tttPlayer)) {
            ticTacToeStatus.textContent = "You win my heart! üíñ";
            tttGameOver = true;
            // Add a heart animation burst in the modal
            showTicTacToeWinFlow();
            return;
          }
          if (checkTicTacToeDraw(tttBoard)) {
            ticTacToeStatus.textContent = "It's a draw! Try again.";
            tttGameOver = true;
            setTimeout(resetTicTacToe, 1200);
            return;
          }
          // AI move (O)
          setTimeout(() => {
            aiTicTacToeMove();
          }, 400);
        }
    // Heart burst and flow to Yes button
    function showTicTacToeWinFlow() {
      // Create a burst of hearts in the modal
      let burstDiv = document.createElement('div');
      burstDiv.style.position = 'absolute';
      burstDiv.style.left = 0;
      burstDiv.style.top = 0;
      burstDiv.style.width = '100%';
      burstDiv.style.height = '100%';
      burstDiv.style.pointerEvents = 'none';
      burstDiv.style.zIndex = 10;
      for (let i = 0; i < 18; i++) {
        let heart = document.createElement('span');
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        heart.style.position = 'absolute';
        heart.style.left = (40 + Math.random() * 20) + '%';
        heart.style.top = '50%';
        heart.style.fontSize = (18 + Math.random() * 10) + 'px';
        heart.style.opacity = 0.8;
        heart.style.transform = 'translateY(0) scale(1)';
        heart.style.transition = 'transform 1.2s cubic-bezier(0.4,1.6,0.6,1), opacity 1.2s';
        setTimeout(() => {
          heart.style.transform = `translateY(-${80 + Math.random()*60}px) scale(${1.1 + Math.random()*0.3}) rotate(${Math.random()*60-30}deg)`;
          heart.style.opacity = 0;
        }, 80 + Math.random()*200);
        burstDiv.appendChild(heart);
      }
      ticTacToeModal.querySelector('.celebration-card').appendChild(burstDiv);
      // Show a cute message and then flow to Yes
      setTimeout(() => {
        ticTacToeStatus.innerHTML = "<span style='font-size:1.3em;'>You truly won my heart!<br>Click below to answer... üíå</span>";
        // Add a big heart button to go to Yes
        let goToYesBtn = document.createElement('button');
        goToYesBtn.className = 'cta';
        goToYesBtn.style.marginTop = '18px';
        goToYesBtn.innerHTML = "Go to the answer üíó";
        goToYesBtn.onclick = function() {
          ticTacToeModal.classList.remove('active');
          yesButton.style.display = 'inline-flex';
          playTicTacToe.style.display = 'none';
          yesButton.focus();
          // Add a floating heart animation from modal to Yes button
          animateHeartToYes();
        };
        ticTacToeStatus.appendChild(goToYesBtn);
        // Remove burst after animation
        setTimeout(() => { if (burstDiv.parentNode) burstDiv.parentNode.removeChild(burstDiv); }, 1400);
      }, 1200);
    }

    function animateHeartToYes() {
      // Find modal and Yes button positions
      const modal = ticTacToeModal.querySelector('.celebration-card');
      const yesRect = yesButton.getBoundingClientRect();
      const modalRect = modal.getBoundingClientRect();
      // Create a floating heart
      let heart = document.createElement('span');
      heart.textContent = 'üíó';
      heart.style.position = 'fixed';
      heart.style.left = (modalRect.left + modalRect.width/2 - 16) + 'px';
      heart.style.top = (modalRect.top + modalRect.height/2 - 16) + 'px';
      heart.style.fontSize = '2.2rem';
      heart.style.zIndex = 1000;
      heart.style.transition = 'all 1.1s cubic-bezier(0.4,1.6,0.6,1)';
      document.body.appendChild(heart);
      setTimeout(() => {
        heart.style.left = (yesRect.left + yesRect.width/2 - 16) + 'px';
        heart.style.top = (yesRect.top + yesRect.height/2 - 16) + 'px';
        heart.style.opacity = 0;
        heart.style.transform = 'scale(1.7)';
      }, 40);
      setTimeout(() => { if (heart.parentNode) heart.parentNode.removeChild(heart); }, 1200);
    }

        function aiTicTacToeMove() {
          if (tttGameOver) return;
          // Simple AI: pick random empty
          const empties = tttBoard.map((c,i) => c ? null : i).filter(i => i !== null);
          if (empties.length === 0) return;
          const idx = empties[Math.floor(Math.random() * empties.length)];
          tttBoard[idx] = "O";
          renderTicTacToe();
          if (checkTicTacToeWin(tttBoard, "O")) {
            ticTacToeStatus.textContent = "Oh no! I win this round. Try again!";
            tttGameOver = true;
            setTimeout(resetTicTacToe, 1200);
            return;
          }
          if (checkTicTacToeDraw(tttBoard)) {
            ticTacToeStatus.textContent = "It's a draw! Try again.";
            tttGameOver = true;
            setTimeout(resetTicTacToe, 1200);
            return;
          }
        }

        function resetTicTacToe() {
          tttBoard = Array(9).fill("");
          tttPlayer = "X";
          tttGameOver = false;
          ticTacToeStatus.textContent = "";
          renderTicTacToe();
        }

        playTicTacToe.addEventListener("click", () => {
          ticTacToeModal.classList.add("active");
          resetTicTacToe();
        });
        closeTicTacToe.addEventListener("click", () => {
          ticTacToeModal.classList.remove("active");
        });
    const celebration = document.getElementById("celebration");
    const burst = document.getElementById("burst");
    const dayCard = document.getElementById("dayCard");
    const dayLock = document.getElementById("dayLock");
    const dayStory = document.getElementById("dayStory");
    const countdown = document.getElementById("countdown");
    const storySteps = Array.from(document.querySelectorAll(".story-step"));
    const prevStep = document.getElementById("prevStep");
    const nextStep = document.getElementById("nextStep");
    const wishGlow = document.getElementById("wishGlow");
    const memoryStack = document.getElementById("memoryStack");
    const memoryCard = document.getElementById("memoryCard");
    const memoryLock = document.getElementById("memoryLock");
    const memoryContainer = document.getElementById("memoryContainer");

    const valentineDate = new Date(new Date().getFullYear(), 1, 14);

    const imageList = [
      { src: "Images/First_Love.jpg", caption: "First Love" },
      { src: "Images/First_appartment.jpg", caption: "Our First Apartment" },
      { src: "Images/Date_night.jpg", caption: "Date Night" },
      { src: "Images/Date_night_2.jpg", caption: "Date Night" },
      { src: "Images/Date_night_3.jpg", caption: "Date Night" },
      { src: "Images/Adventure.jpg", caption: "Adventure Time" },
      { src: "Images/adventure_2.jpg", caption: "Exploring" },
      { src: "Images/Adventure_3.jpg", caption: "Us" },
      { src: "Images/Adventure_4.jpg", caption: "Adventures" },
      { src: "Images/Adventure_5.jpg", caption: "More Adventures" },
      { src: "Images/Adventure_6.jpg", caption: "Wanderlust" },
      { src: "Images/Birthday.jpg", caption: "Birthday Joy" },
      { src: "Images/Christmass.jpg", caption: "Christmas Magic" },
      { src: "Images/Christmass_2.jpg", caption: "Festive Vibes" },
      { src: "Images/Graduated.jpg", caption: "Proud Moments" },
      { src: "Images/Engagement.jpg", caption: "She Said Yes" },
      { src: "Images/Engagement_2.jpg", caption: "Engaged!" },
      { src: "Images/Venue.jpg", caption: "The Place" },
      { src: "Images/Wedding.jpg", caption: "Best Day Ever" },
      { src: "Images/Wedding_2.jpg", caption: "Just Married" },
      { src: "Images/Wedding_3.jpg", caption: "Forever Us" },
      { src: "Images/Honeymoon_start.jpg", caption: "Honeymoon Begins" },
      { src: "Images/Honeymoon_beach.jpg", caption: "Paradise" },
      { src: "Images/Honeymonn_sea.jpg", caption: "By the Sea" },
      { src: "Images/Honeymoon_2.jpg", caption: "Honeymoon Bliss" },
      { src: "Images/Honeymoon_3.jpg", caption: "Love Trip" },
      { src: "Images/Sea.jpg", caption: "Ocean Breeze" }
    ];

    const shuffle = (array) => {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    };

    const loadMemories = () => {
      memoryStack.innerHTML = '';
      const shuffled = shuffle([...imageList]);
      
      shuffled.forEach((imgData, index) => {
        const card = document.createElement("div");
        card.className = "polaroid";
        card.dataset.caption = imgData.caption;
        
        const rotation = Math.random() * 10 - 5;
        const offsetX = Math.random() * 4 - 2;
        const offsetY = Math.random() * 4 - 2;
        card.style.transform = `translate(calc(-50% + ${offsetX}px), calc(-50% + ${offsetY}px)) rotate(${rotation}deg)`;
        card.style.zIndex = index;
        
        const img = document.createElement("img");
        img.src = imgData.src;
        img.alt = imgData.caption;
        img.loading = "lazy";
        
        card.appendChild(img);
        memoryStack.appendChild(card);
      });
    };

    const cycleMemory = () => {
      const cards = Array.from(memoryStack.querySelectorAll('.polaroid'));
      if (cards.length === 0) return;
      
      const topCard = cards[cards.length - 1];
      topCard.classList.add("fly-out");
      
      setTimeout(() => {
        topCard.classList.add("reset");
        topCard.classList.remove("fly-out");
        
        // Move to bottom of stack
        memoryStack.prepend(topCard);
        
        // Force reflow
        void topCard.offsetWidth;
        
        // Remove reset and reapply styling
        topCard.classList.remove("reset");
        
        // Update all z-indices to maintain proper stacking
        const allCards = Array.from(memoryStack.querySelectorAll('.polaroid'));
        allCards.forEach((card, index) => {
          card.style.zIndex = index;
          if (card === topCard) {
            const rotation = Math.random() * 10 - 5;
            const offsetX = Math.random() * 4 - 2;
            const offsetY = Math.random() * 4 - 2;
            card.style.transform = `translate(calc(-50% + ${offsetX}px), calc(-50% + ${offsetY}px)) rotate(${rotation}deg)`;
          }
        });
      }, 700);
    };

    // Memory lock logic
    function updateMemoryLock() {
      const now = new Date();
      if (now >= valentineDate) {
        memoryCard.style.display = "";
        memoryLock.style.display = "none";
        memoryContainer.style.display = "flex";
      } else {
        memoryCard.style.display = "block";
        memoryLock.style.display = "block";
        memoryContainer.style.display = "none";
        // Hide the whole card except the lock
        memoryCard.querySelector('h2').style.display = 'none';
        memoryCard.querySelector('.instruction-hint').style.display = 'none';
      }
    }
    // On unlock, restore title and hint
    function showMemoryCardContent() {
      if (memoryCard) {
        const h2 = memoryCard.querySelector('h2');
        const hint = memoryCard.querySelector('.instruction-hint');
        if (h2) h2.style.display = '';
        if (hint) hint.style.display = '';
      }
    }

    memoryStack.addEventListener("click", cycleMemory);
    loadMemories();
    updateMemoryLock();
    if (new Date() >= valentineDate) showMemoryCardContent();

    const hearts = ["üíó", "üíñ", "üíû", "üíì", "üíï"];
    let activeStep = 0;

    const launchHearts = () => {
      burst.innerHTML = "";
      for (let i = 0; i < 26; i += 1) {
        const heart = document.createElement("span");
        heart.className = "burst-heart";
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        heart.style.left = `${Math.random() * 100}%`;
        heart.style.animationDelay = `${Math.random() * 0.6}s`;
        heart.style.fontSize = `${14 + Math.random() * 10}px`;
        burst.appendChild(heart);
      }
    };

    yesButton.addEventListener("click", () => {
      yesButton.textContent = "You said yes! üíó";
      yesButton.disabled = true;
      celebration.classList.add("active");
      launchHearts();
    });

    celebration.addEventListener("click", (event) => {
      if (event.target === celebration) {
        celebration.classList.remove("active");
        yesButton.disabled = false;
        yesButton.textContent = "Yes, always üíó";
      }
    });

    // const valentineDate = new Date("2025-02-10T00:00:00");

    const updateCountdown = () => {
      const now = new Date();
      if (now >= valentineDate) {
        dayLock.style.display = "none";
        dayStory.classList.add("active");
        return;
      }

      const diff = valentineDate - now;
      const days = Math.max(0, Math.floor(diff / (1000 * 60 * 60 * 24)));
      const hours = Math.max(0, Math.floor((diff / (1000 * 60 * 60)) % 24));
      const minutes = Math.max(0, Math.floor((diff / (1000 * 60)) % 60));
      countdown.textContent = `${days} days ${hours} hours ${minutes} mins`;
    };

    const showStep = (index) => {
      storySteps.forEach((step, i) => {
        step.classList.toggle("active", i === index);
      });
      prevStep.disabled = index === 0;
      nextStep.textContent = index === storySteps.length - 1 ? "Start Over" : "Next Chapter";
    };

    prevStep.addEventListener("click", () => {
      if (activeStep > 0) {
        activeStep -= 1;
        showStep(activeStep);
      }
    });

    nextStep.addEventListener("click", () => {
      if (activeStep === storySteps.length - 1) {
        activeStep = 0;
      } else {
        activeStep += 1;
      }
      showStep(activeStep);
    });

    wishGlow.addEventListener("click", () => {
      launchHearts();
      celebration.classList.add("active");
      
      cycleMemory();
      
      const stackCard = memoryStack.closest('.card');
      if (stackCard) {
        stackCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
        stackCard.classList.add('glow');
        setTimeout(() => stackCard.classList.remove('glow'), 2000);
      }

      setTimeout(() => {
        celebration.classList.remove("active");
      }, 2200);
    });

    showStep(activeStep);
    updateCountdown();
    setInterval(updateCountdown, 60000);
    setInterval(() => {
      updateMemoryLock();
      if (new Date() >= valentineDate) showMemoryCardContent();
    }, 60000);
  </script>
</body>
</html>
